add_executable(test_bte test_bte.cpp)
target_link_libraries(test_bte tpie)

add_executable(streaming streaming.cpp)
target_link_libraries(streaming tpie)

add_executable(stream_test stream.cpp)
target_link_libraries(stream_test tpie)


if(NOT WIN32) 
set(BTES ${BTES} ufs mmap)
endif(NOT WIN32)
set(BTES ${BTES} ami_stream cache stdio)

add_test(streaming::stream_source--memory streaming stream_source memory)
add_test(streaming::stream_source::minimum_memory streaming stream_source minimum_memory)
add_test(streaming::stream_source::process streaming stream_source process)
add_test(streaming::stream_source::process_back streaming stream_source process_back)
add_test(streaming::stream_sink--memory streaming stream_sink memory)
add_test(streaming::stream_sink::minimum_memory streaming stream_sink minimum_memory)
add_test(streamirg::stream_sink--process streaming stream_sink process)
add_test(streaming::sort--memory streaming sort memory)
add_test(streaming::sort--minimum_memory streaming sort minimum_memory)
add_test(streaming::sort--process streaming sort process)
add_test(streaming::pull_sort--memory streaming pull_sort memory)
add_test(streaming::pull_sort--minimum_memory streaming pull_sort minimum_memory)
add_test(streaming::pull_sort--process streaming pull_sort process)
add_test(streaming::buffer--memory streaming buffer memory)
add_test(streaming::buffer--minimum_memory streaming buffer minimum_memory)
add_test(streaming::buffer--process streaming buffer process)
add_test(streaming::pull_buffer--memory streaming pull_buffer memory)
add_test(streaming::pull_buffer--minimum_memory streaming pull_buffer minimum_memory)
add_test(streaming::pull_buffer--process streaming pull_buffer process)
add_test(streaming--virtual--memory streaming virtual memory)
add_test(streaming--virtual--minimum_memory streaming virtual minimum_memory)
add_test(streaming--virtual--process streaming virtual process)

#foreach(bte ${BTES})
#  foreach(test basic randomread array)
#    add_test(bte_${bte}_${test} test_bte ${bte} ${test})
#  endforeach(test)
#endforeach(bte)

add_test(file_accessor_stdio stream_test file_accessor_stdio)
add_test(file_stream stream_test file_stream)
add_test(substreams stream_test substreams)
#add_test(fd_file stream_test fd_file)
